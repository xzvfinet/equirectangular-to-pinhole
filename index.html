<!DOCTYPE html>
<html>

<head>
    <title></title>
    <!-- <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script> -->
    <canvas id="mycanvas"></canvas>
    <style type="text/css">

    </style>
</head>

<body onload="loaded()">
</body>
<script type="text/javascript">
var img = new Image;
var canvas = document.getElementById("mycanvas");
var ctx = canvas.getContext("2d");
var src = "https://xzvfinet.github.io/equirectangular-to-pinhole/360.jpg";
var ratio = 1;
var drawObjects = [];

function loaded() {

    img.crossOrigin = "Anonymous";

    img.onload = function() {
        ratio = 1024 / img.width;
        canvas.width = img.width * ratio;
        canvas.height = img.height * ratio;

        var newImageData = ctx.createImageData(50, 50);
        var data = newImageData.data;
        for (var i = 0; i < data.length; i += 4) {
            // data[i] = 255 - data[i]; // red
            // data[i + 1] = 255 - data[i + 1]; // green
            // data[i + 2] = 255 - data[i + 2]; // blue
            data[i + 3] = 255;
        }
        drawObjects.push({
            imageData : newImageData,
            x: 250, y: 250
        });

        update();
    }
    img.src = src;
}

function update() {
    // draw 360 image
    ctx.drawImage(img, 0, 0, img.width * ratio, img.height * ratio);

    for (var i = 0; drawObjects.length; ++i)
        ctx.putImageData(drawObjects[i].imageData, drawObjects[i].x, drawObjects[i].y);

    // ctx.drawImage(img, 0, 0, img.width * ratio, img.height * ratio);
    // var pixelData = ctx.getImageData(250, 250, 50, 50).data;

}
</script>

</html>
